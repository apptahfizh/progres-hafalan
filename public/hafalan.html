<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Data Hafalan</title>
  </head>
  <body>
    <h1>Data Hafalan Anak</h1>

    <table border="1" cellpadding="8">
      <thead>
        <tr>
          <th>Tanggal</th>
          <th>Surah</th>
          <th>Ayat</th>
          <th>Keterangan</th>
        </tr>
      </thead>
      <tbody id="hafalanBody">
        <tr>
          <td colspan="4">Memuat data...</td>
        </tr>
      </tbody>
    </table>

    <br />
    <a href="/dashboard.html">â¬… Kembali ke Dashboard</a>

    <!-- AUTH GUARD (WAJIB) -->
    <script src="/assets/js/auth.js"></script>
    <script src="/assets/js/auth-guard.js"></script>

    <script>
      const token = localStorage.getItem("token");

      fetch("/api/hafalan", {
        headers: {
          Authorization: "Bearer " + token,
        },
      })
        .then((res) => {
          if (!res.ok) throw new Error("Akses ditolak");
          return res.json();
        })
        .then((data) => {
          const tbody = document.getElementById("hafalanBody");
          tbody.innerHTML = "";

          if (data.length === 0) {
            tbody.innerHTML = "<tr><td colspan='4'>Belum ada data</td></tr>";
            return;
          }

          data.forEach((row) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
        <td>${row.tanggal}</td>
        <td>${row.surah}</td>
        <td>${row.ayat_hafal}</td>
        <td>${row.keterangan || "-"}</td>
      `;
            tbody.appendChild(tr);
          });
        })
        .catch((err) => {
          alert("Gagal memuat data hafalan");
          console.error(err);
        });
    </script>
  </body>
</html>
